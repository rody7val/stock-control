//- index.jade
mixin input_radio(text, test)
	each value, key in test
		- attributes[key] = value
	input.custom-control-input&attributes(attributes) 
	span.custom-control-indicator
	span.custom-control-description !{text}

extends ./layout.jade

block css
	link(href='/css/item/index.css', rel="stylesheet", type="text/css")

block content
	.head-title
		h1.text-center.light Stock actual
	#stock
		.container
			.row
				.col-md-12
					nav#find-bar.navbar.navbar-light.bg-faded
						form(action='/item/find',method='get')
							.input-group
								.input-group-btn
									button.btn.btn-secondary.dropdown-toggle(
										data-toggle='dropdown'
										aria-haspopup='true'
										aria-expanded='false'
									) Buscar por
									.dropdown-menu
										a.dropdown-item
											label.custom-control.custom-radio
												if key !== 'code'
													+input_radio('Nombre', { type: 'radio', name: 'key', value: 'name', checked: '' })
												else
													+input_radio('Nombre', { type: 'radio', name: 'key', value: 'name'})
										a.dropdown-item
											label.custom-control.custom-radio
												if key == 'code'
													+input_radio('Código', { type: 'radio', name: 'key', value: 'code', checked: '' })
												else
													+input_radio('Código', { type: 'radio', name: 'key', value: 'code'})
								.left
									input#find-input.form-control(
										type='text'
										name='value'
										placeholder='Buscar'
										value='#{value ? value : ""}'
									)
								input.btn.btn-outline-success(type='submit', value="Buscar")
			.row
				.col-md-12
					table.table.table-hover
						thead.thead-inverse
							tr
								th Items
								th Stock
								th $/u
								th Código
								th Acciones
						tbody
							if items.length
								each item in items
									tr
										//- Items
										td: a.btn.btn-link.btn-sm(href='/item/#{item._id}') #{item.name ? item.name : "Sin nombre"}
										//- Stock
										td(class="#{item.qty === 0 ? 'alert-danger' : 'alert-success'}") #{item.qty}
										//- $/u
										td #{item.price}
										//- Código
										td #{item.code}
										//- Acciones
										td
											a.left.btn.btn-outline-secondary.btn-sm(href='/item/#{item._id}/edit') Editar
											form(method='post', action='/item/#{item._id}?_method=delete')
												input.left.btn.btn-outline-danger.btn-sm(
													type='submit'
													value='Borrar'
													onClick='return confirm("Eliminar: #{item.name ? item.name : "Sin nombre"}?")'
												)
							else
								tr
									td(colspan="5"): p.text-center No hay ningun item con #{key !== 'code' ? ('nombre (' + value +')') : ('código (' + value +')')}.